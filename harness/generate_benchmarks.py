import random
from pathlib import Path

def generate_random_3sat(num_vars, num_clauses):
    clauses = []
    for _ in range(num_clauses):
        clause = []
        while len(clause) < 3:
            var = random.randint(1, num_vars)
            sign = random.choice([-1, 1])
            lit = var * sign
            if lit not in clause and -lit not in clause:
                clause.append(lit)
        clauses.append(clause)
    return clauses

def write_dimacs(filename, num_vars, num_clauses, clauses):
    with open(filename, 'w') as f:
        f.write(f"c Random 3-SAT instance generated by generate_benchmarks.py\n")
        f.write(f"p cnf {num_vars} {num_clauses}\n")
        for clause in clauses:
            f.write(" ".join(map(str, clause)) + " 0\n")

def main():
    configs = [
        (50, 213),
        (100, 426),
        (150, 639),
        (200, 852)
    ]
    num_instances_per_config = 20
    output_dir = Path("benchmarks/random_sat")
    output_dir.mkdir(parents=True, exist_ok=True)
    for num_vars, num_clauses in configs:
        for i in range(1, num_instances_per_config + 1):
            clauses = generate_random_3sat(num_vars, num_clauses)
            filename = output_dir / f"random_3sat_{num_vars}v_{num_clauses}c_{i:02d}.cnf"
            write_dimacs(filename, num_vars, num_clauses, clauses)

if __name__ == "__main__":
    main()
